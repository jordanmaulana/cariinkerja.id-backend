{% extends "dashboard_base.html" %}
{% load humanize %}
{% load format_number %}
{% block head %}
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock head %}
{% block content %}
  <main class="space-y-8">
    <!-- Overview Statistics -->
    <section class="grid grid-cols-4 gap-4">
      <div class="p-4 rounded-lg border shadow-sm space-y-2">
        <p class="text-slate-600 font-medium">Total Users</p>
        <p class="text-3xl font-bold text-blue-600">
          {{ user_count|intdot }} <span class="text-sm text-slate-500">users</span>
        </p>
        <p class="text-slate-400">{{ users_registered_today|intdot }} registered today</p>
      </div>
      
      <div class="p-4 rounded-lg border shadow-sm space-y-2">
        <p class="text-slate-600 font-medium">Total Jobs</p>
        <p class="text-3xl font-bold text-green-600">
          {{ total_jobs|intdot }} <span class="text-sm text-slate-500">jobs</span>
        </p>
        <p class="text-slate-400">{{ jobs_posted_today|intdot }} posted today</p>
      </div>
      
      <div class="p-4 rounded-lg border shadow-sm space-y-2">
        <p class="text-slate-600 font-medium">Job Assessments</p>
        <p class="text-3xl font-bold text-purple-600">
          {{ total_assessments|intdot }} <span class="text-sm text-slate-500">assessments</span>
        </p>
        <p class="text-slate-400">{{ assessments_today|intdot }} created today</p>
      </div>
      
      <div class="p-4 rounded-lg border shadow-sm space-y-2">
        <p class="text-slate-600 font-medium">Avg Assessment Score</p>
        <p class="text-3xl font-bold text-orange-600">
          {{ avg_assessment_score }} <span class="text-sm text-slate-500">/100</span>
        </p>
        <p class="text-slate-400">Overall match quality</p>
      </div>
    </section>

    <!-- Job Distribution Charts -->
    <section class="grid grid-cols-2 gap-6">
      <!-- Employment Type Distribution -->
      <div class="p-6 rounded-lg border shadow-sm">
        <h3 class="text-lg font-semibold mb-4">Employment Type Distribution</h3>
        <div class="space-y-3">
          {% for stat in employment_type_stats %}
            <div class="flex justify-between items-center">
              <span class="capitalize text-slate-700">{{ stat.employment_type|title }}</span>
              <div class="flex items-center space-x-2">
                <div class="w-24 bg-gray-200 rounded-full h-2">
                  <div class="bg-blue-500 h-2 rounded-full" style="width: {% widthratio stat.count total_jobs 100 %}%"></div>
                </div>
                <span class="text-sm font-medium text-slate-600">{{ stat.count }}</span>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>

      <!-- Work Location Distribution -->
      <div class="p-6 rounded-lg border shadow-sm">
        <h3 class="text-lg font-semibold mb-4">Work Location Distribution</h3>
        <div class="space-y-3">
          {% for stat in work_location_stats %}
            <div class="flex justify-between items-center">
              <span class="capitalize text-slate-700">{{ stat.work_location|title }}</span>
              <div class="flex items-center space-x-2">
                <div class="w-24 bg-gray-200 rounded-full h-2">
                  <div class="bg-green-500 h-2 rounded-full" style="width: {% widthratio stat.count total_jobs 100 %}%"></div>
                </div>
                <span class="text-sm font-medium text-slate-600">{{ stat.count }}</span>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </section>

    <!-- Additional Statistics -->
    <section class="grid grid-cols-2 gap-6">
      <!-- Top Job Categories -->
      <div class="p-6 rounded-lg border shadow-sm">
        <h3 class="text-lg font-semibold mb-4">Top Job Categories</h3>
        <div class="space-y-3">
          {% for stat in job_category_stats %}
            <div class="flex justify-between items-center">
              <span class="capitalize text-slate-700">{{ stat.job_title_category|title }}</span>
              <div class="flex items-center space-x-2">
                <div class="w-24 bg-gray-200 rounded-full h-2">
                  <div class="bg-purple-500 h-2 rounded-full" style="width: {% widthratio stat.count total_jobs 100 %}%"></div>
                </div>
                <span class="text-sm font-medium text-slate-600">{{ stat.count }}</span>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>

      <!-- Source Platforms -->
      <div class="p-6 rounded-lg border shadow-sm">
        <h3 class="text-lg font-semibold mb-4">Source Platforms</h3>
        <div class="space-y-3">
          {% for stat in source_platform_stats %}
            <div class="flex justify-between items-center">
              <span class="text-slate-700">{{ stat.source_platform }}</span>
              <div class="flex items-center space-x-2">
                <div class="w-24 bg-gray-200 rounded-full h-2">
                  <div class="bg-orange-500 h-2 rounded-full" style="width: {% widthratio stat.count total_jobs 100 %}%"></div>
                </div>
                <span class="text-sm font-medium text-slate-600">{{ stat.count }}</span>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </section>
  </main>
{% endblock content %}
